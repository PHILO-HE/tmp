select
id as col_65263,
col_28543,
col_78590 as col_78590,
col_13174 as col_75157,
coalesce(cast(get_json_object(col_28120, '$.col_3859') as bigint), 0) as col_3859,
coalesce(get_json_object(col_28120, '$.ip'),'') as ip,
coalesce(cast(get_json_object(col_28120, '$.daily_index') as bigint), 1) as col_94384,
case when col_8394unixcol_24989(col_77931, 'yyyyMMdd')='20200831' then 1 else 0 end as col_76448,
coalesce(get_json_object(col_51602, '$.col_72360'), '') as col_40862,
coalesce(get_json_object(col_51602, '$.col_47654'), -1) as col_37613,
coalesce(get_json_object(col_51602, '$.col_87040'), -1) as col_16709,
coalesce(get_json_object(col_51602, '$.col_94815'), 0) as col_38410,
coalesce(cast(get_json_object(col_28120, '$.col_84806')as bigint), -1) as col_75377,
col_23006 as col_89703,
coalesce(get_json_object(col_28120, '$.reviewed'), '-1') as col_78874,
coalesce(get_json_object(col_28120, '$.col_26104'), -1) as col_69276,
coalesce(get_json_object(col_28120, '$.col_51363'), -1) as col_61027,
col_5963 as col_23338,
coalesce(get_json_object(col_28120, '$.col_98264'), 0) as col_598,
coalesce(get_json_object(col_28120, '$.full_screen'), -1) as col_70083,
coalesce(get_json_object(col_28120, '$.transition_col_50426'), -1) as col_21797,
coalesce(get_json_object(col_28120, '$.col_3775'), -1) as col_17190,
col_77931 as col_21384,
col_8394unixcol_24989(col_77931, 'yyyy-MM-dd HH:mm:ss') as col_74015,
col_8394unixcol_24989(col_77931, 'yyyyMMdd') as col_39375,
col_86387 as col_11077,
col_8394unixcol_24989(col_86387, 'yyyy-MM-dd HH:mm:ss') as col_59514,
col_8394unixcol_24989(col_86387, 'yyyyMMdd') as col_80044,
coalesce(get_json_object(col_51602, '$.col_87630'),0) as col_99537,
coalesce(get_json_object(col_51602, '$.col_15724'), -1) as col_15724,
concat('https://www.douyin.com/col_6863/video/', id, '/?mid=', coalesce(get_json_object(col_51602, '$.col_87630'),0))as col_87108,
coalesce(get_json_object(col_51602, '$.col_53796'), '') as col_53796,
coalesce(get_json_object(col_28120, '$.col_88136'), '') as col_88136,
coalesce(get_json_object(col_28120, '$.col_62640'), '') as col_63119,
coalesce(get_json_object(col_28120, '$.camera'), '') as col_28048,
coalesce(get_json_object(col_28120, '$.prettify'), '') as col_57679,
coalesce(get_json_object(col_28120, '$.fx_col_29499'), '') as col_93979,
coalesce(get_json_object(col_28120, '$.col_72628'), '') as col_90212,
case when cast(get_json_object(col_51602, '$.col_79996')as bigint)>0 then 1 else 0 end as col_10063,
coalesce(get_json_object(col_51602, '$.col_56529_spf'),get_json_object(col_51602, '$.col_56529'), '') as col_56529,
coalesce(get_json_object(col_51602, '$.col_37469'), '') as col_37469,
coalesce(get_json_object(col_28120, '$.col_61894'), '') as col_16207,
coalesce(get_json_object(col_28120, '$.col_66825'), '') as col_18073,
coalesce(get_json_object(col_28120, '$.col_30272'), '') as col_30272,
coalesce(regexp_replace(get_json_object(col_51602, '$.col_99249'), '\\\[|\\\]', ''), '') as col_97887,
coalesce(get_json_object(col_28120, '$.col_84978'), '') as col_84978,
coalesce(get_json_object(col_28120, '$.col_16269'), '') as col_16269,
coalesce(get_json_object(col_28120, '$.col_7286'), -1) as col_7286,
coalesce(get_json_object(col_51602, '$.col_17147'), -1) as col_17147,
coalesce(get_json_object(col_51602, '$.smoking'), -1) as col_84093,
coalesce(get_json_object(col_51602, '$.logo_col_50426'), -1) as col_9142,
coalesce(get_json_object(col_51602, '$.auto_transcode'), -1) as col_5518,
col_28120,
col_51602,
coalesce(get_json_object(col_51602, '$.col_79996'), '') as col_79996,
coalesce(get_json_object(col_28120,'$.col_60463'), 'false') as col_49992,
coalesce(get_json_object(col_28120,'$.col_86633'), -1) as col_86633,
coalesce(get_json_object(col_28120,'$.col_8764'), '') as col_8764,
coalesce(get_json_object(col_28120, '$.col_59507_item'), 0) as col_34252,
coalesce(get_json_object(col_28120, '$.info_col_72628'), '') as col_51657,
coalesce(get_json_object(col_28120, '$.warn'), 'false') as col_46593,
coalesce(get_json_object(col_28120, '$.risk_sink'), 'false') as col_9363,
case when get_json_object(col_51602, '$.col_72805')=1 or (get_json_object(col_51602,'$.long_video') is not null and get_json_object(col_51602,'$.long_video') !='') then 1 else 0 end as col_29502,
coalesce(get_json_object(col_28120, '$.col_91453'), '') as col_91453,
coalesce(get_json_object(col_28120, '$.col_69236'), 0) as col_69236,
coalesce(get_json_object(col_28120, '$.col_93128'), '') as col_93128,
coalesce(get_json_object(col_51602, '$.col_87889'), -1) as col_87889,
coalesce(get_json_object(get_json_object(col_28120, '$.col_24989r'), '$.col_23006'), -1) as col_42304,
coalesce(get_json_object(get_json_object(col_28120, '$.anchor'), '$.col_50426'), -1) as col_517,
coalesce(get_json_object(get_json_object(col_28120, '$.anchor'), '$.col_95097'), -1) as col_94573,
map(
    'is_edit_col_93080', case when get_json_object(col_28120, '$.edit_id') > 0 then '1' else '0' end,
    'col_24989r_col_94815', case when get_json_object(col_28120, '$.col_24989r') is not null then cast(cast(get_json_object(get_json_object(col_28120, '$.col_24989r'),'$.public_col_24989') as bigint)-cast(get_json_object(get_json_object(col_28120, '$.col_24989r'),'$.col_77931') as bigint) as string) else '0' end,
    'ancestor_col_80043',COALESCE(cast(get_json_object(get_json_object(get_json_object(col_28120, '$.ancestor'), '$.col_28120'),'$.stock') as string),'-1'),
    'ancestor_col_65263', COALESCE(cast(get_json_object(get_json_object(col_28120, '$.ancestor'), '$.col_65263') as string),'-1'),
    'ancestor_col_13174', COALESCE(cast(get_json_object(get_json_object(col_28120, '$.ancestor'), '$.col_13174') as string),'-1'),
    'ancestor_item_col_9664',COALESCE(cast(get_json_object(get_json_object(get_json_object(col_28120, '$.ancestor'), '$.col_28120'),'$.col_9664') as string),'-1'),
    'ancestor_col_28543', COALESCE(get_json_object(get_json_object(col_28120, '$.ancestor'), '$.col_12026'),'-1'),
    'col_73453',get_json_object(col_28120, '$.col_73453'),
    'item_anchor_state',coalesce(cast(get_json_object(get_json_object(col_28120, '$.anchor'), '$.stats') as string), '-1')
    ) as col_23140
from 
    (
    SELECT
        id,
        col_13174,
        col_5963,
        col_51602,
        col_28543,
        col_23006,
        col_78590,
        col_77931,
        col_86387,
        col_28120
    FROM
        tbl_6597
    WHERE
        col_28543=1128 and date='20200831' and col_8394unixcol_24989(cast(col_77931 as bigint),'yyyyMMdd')<='20200831'
UNION ALL
    SELECT
        id,
        col_13174,
        col_5963,
        col_51602,
        col_28543,
        col_23006,
        col_78590,
        col_77931,
        col_86387,
        col_28120
    FROM
        tbl_2615
    WHERE
        col_28543=1112 and date='20200831' and col_8394unixcol_24989(cast(col_77931 as bigint),'yyyyMMdd')<='20200831'
    )x
limit 10000
